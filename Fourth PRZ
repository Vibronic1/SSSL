# Практическая работа №4 по предмету "Система для сбора событий и логов"

Выполнил студент группы **ББМО-02-23** – **Брестер Андрей Николаевич**  

## Цель работы  
Исследовать процесс анализа сетевых логов и выявления аномальных сетевых событий с использованием инструментов AC-Hunter и VirusTotal.  

## Задачи  

1. Подготовить рабочую среду и необходимые данные.  
2. Выполнить анализ логов с использованием AC-Hunter.  
3. Выявить подозрительные соединения, используя VirusTotal.  
4. Осуществить разбор аномального сетевого трафика.  
5. Составить выводы на основе проведенного анализа.  

## Ход выполнения работы  

### 1. Подготовка рабочей среды  
- Определен IP-адрес хоста для анализа.  

![Скриншот 1 – Демонстрация IP-адреса хоста]  

### 2. Вход в прикладное ПО  
- Осуществлен вход в AC-Hunter для анализа логов.  
![Скриншот 2 – Вход в прикладное ПО]  

### 3. Анализ сетевого трафика  

#### 3.1 Выбор датасета для анализа  
- Выбран датасет `dnscat2-ja3`.  
![Скриншот 3 – Выбор датасета dnscat2-ja3]  

- Изучен интерфейс AC-Hunter.  
![Скриншот 4 – Интерфейс AC-Hunter]  

#### 3.2 Фильтрация легитимного трафика  
- Добавлено легитимное подключение к Skype в safelist.  
![Скриншот 5 – Добавление легитимного подключения в safelist]  

### 4. Анализ логов  

#### 4.1 Загрузка и исследование логов (1 часть работы)  
- Импортированы логи в AC-Hunter.  
![Скриншот 6 – Импорт логов]  

- Выбраны логи для обработки.  
![Скриншот 7 – Выбор логов]  

- Найдено подозрительное подключение с IP **104.248.234.238**.  
![Скриншот 8 – Первая запись]  

- Обнаружены сервисные соединения Windows.  
![Скриншот 9 – Вторая запись]  

- Проанализированы логи подозрительного подключения.  
![Скриншот 10 – Анализ логов]  

- Выполнена проверка подозрительных IP-адресов через VirusTotal.  
![Скриншоты 11-12 – Проверка в VirusTotal]  

### Выводы по 1 части анализа  
1) Была заменена строка User-Agent.  
2) Отсутствует поле `host` в HTTP-заголовке.  
3) Зафиксировано **3011 соединений за короткий срок**.  
4) Остальные подключения идут к службам Microsoft и добавлены в safelist.  

---

#### 4.2 Загрузка и анализ логов (2 часть работы)  
- Загрузка логов в AC-Hunter.  
![Скриншот 13 – Загрузка логов]  

- Выявлено **большое количество DNS-запросов**.  
![Скриншот 14 – Анализ в AC-Hunter]  

![Скриншоты 15-16 – Гистограммы DNS-запросов]  

### Выводы по 2 части анализа  
Анализ показал **аномально высокий уровень DNS-запросов**, что указывает на возможную **C2-атаку через DNS**.  

---

#### 4.3 Загрузка и анализ логов (3 часть работы)  
- Загрузка логов.  
![Скриншот 17 – Загрузка логов]  

- Анализ записей в AC-Hunter.  
![Скриншот 18 – Анализ логов]  

- Обнаружено подозрительное имя в Skype.  
![Скриншот 19 – Подозрительное имя Skype]  

- Проверка IP-адреса через VirusTotal показала высокий уровень риска.  
![Скриншот 20 – Проверка в VirusTotal]  

### Выводы по 3 части анализа  
На основе результатов:
- Графики (гистограммы) **имеют плоскую структуру**.
- VirusTotal **определил IP-адрес как подозрительный**.
- Обнаружено **некорректное имя в Skype**.  
**Вывод:** зафиксировано поведение, соответствующее **http-beacon атаке**.  

## Общий вывод  
В ходе работы проведен анализ логов сетевого трафика с выявлением аномального поведения. Использованы инструменты **AC-Hunter** и **VirusTotal** для оценки угроз. Обнаружены потенциально вредоносные активности, среди которых **C2-атака через DNS** и **http-beacon активность**.  
